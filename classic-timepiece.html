<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classic Timepiece - BIDHUB</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="logo">BIDHUB</div>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="#" id="downloadReport">Auctions</a></li>
            <li><a href="#">How It Works</a></li>
        </ul>
    </nav>

    <div class="container">
        <div class="item-image">
            <img id="product-img" src="https://i.pinimg.com/474x/68/35/a2/6835a2a0525ff7b3b1a42609d7b3079c.jpg" alt="Classic Timepiece">
        </div>
        <div class="item-details">
            <h2 id="product-name">Classic Rolex Timepiece</h2>
            <p class="location">üìç London, UK</p>
            <h3>Bid History</h3>
            <ul class="bid-history" id="bid-history">
                <li>üí∞ $5,000 - UserX (10 mins ago)</li>
                <li>üí∞ $4,800 - UserY (1 hour ago)</li>
                <li>üí∞ $4,500 - UserZ (3 hours ago)</li>
            </ul>
        </div>
    </div>

    <script>
        document.getElementById("downloadReport").addEventListener("click", function () {
            generateExcelReport();
        });

        function generateExcelReport() {
            let bidHistoryList = document.querySelectorAll("#bid-history li");
            let data = [["Bidder", "Bid Amount", "Item Name", "Date"]];

            bidHistoryList.forEach((bid) => {
                let bidText = bid.innerText.replace("üí∞ ", "").split(" - ");
                let amount = bidText[0];
                let bidder = bidText[1];
                let date = new Date().toISOString().split("T")[0];
                data.push([bidder, amount, "Classic Rolex Timepiece", date]);
            });

            let ws = XLSX.utils.aoa_to_sheet(data);
            let wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Auction Report");
            XLSX.writeFile(wb, "Auction_Report.xlsx");
        }
    </script>
</body>
</html>
